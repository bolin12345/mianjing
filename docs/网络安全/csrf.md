---
title: "CSRF(跨站请求伪造)"
---

# 跨站请求伪造（Cross-Site Request Forgery，简称 CSRF）

通过诱使用户在已认证的 web 应用程序上执行非预期操作。

## 原理

利用用户已经登录的身份，向目标网站发送恶意请求。攻击者通过诱使用户点击恶意链接或访问恶意网站，利用用户身份执行恶意操作。由于浏览器会自动发送用户身份验证信息（如 cookie），服务器无法区分该请求是用户自己发起还是攻击者伪造。

## 防护措施

### 1. CSRF Token

- **生成和存储 Token**：在用户登录时生成一个随机的 CSRF Token，并将其存储在用户的会话中。
- **嵌入表单**：在每个表单中嵌入 CSRF Token，作为隐藏字段。
- **验证 Token**：服务器在处理表单提交时，验证请求中的 CSRF Token 是否与会话中的 Token 匹配。
- **设置过期时间**：为 CSRF Token 设置过期时间，定期刷新以增加安全性。

### 2. 验证 Referer 和 Origin 头

- **Referer 头**：请求头中包含 Referer，服务器可以通过检查 Referer 头来判断请求来源是否可信。
- **Origin 头**：对于某些现代浏览器，可以检查 Origin 头来进一步确认请求来源。

### 3. 验证码

- **动态验证码**：在关键操作（如转账、修改密码等）时，要求用户输入验证码，增加攻击难度。
- **图形验证码**：使用图形验证码，防止自动化工具的攻击。
